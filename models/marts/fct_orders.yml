models:
  - name: fct_orders
    columns:
      - name: amount_usd
        tests:
          - decimal
          # - greater_than_zero
          # - greater_than_number:
          #     number: 1000


unit_tests:
  - name: check_fiscal_quarters
    description: >
      "Check that fiscal quarters prior to 2025 match calendar quarters. 
      Starting in 2025 check that fiscal quarters are a full quarter ahead of calendar quarter"
    model: fct_orders
    given:
      - input: ref('stg_jaffle_shop__orders')
        rows:
          - {order_id: 1, order_date: 2022-12-01}
          - {order_id: 2, order_date: 2025-12-01}
          - {order_id: 3, order_date: 2025-02-01}
          - {order_id: 4, order_date: 2022-02-01}
      - input: ref('stg_stripe__payment')
        rows:
          - {order_id: 1}
          - {order_id: 2}
          - {order_id: 3}
          - {order_id: 4}
    expect:
      rows:
          - {order_id: 1, fiscal_quarter: Q4 2022}
          - {order_id: 2, fiscal_quarter: Q1 2026}
          - {order_id: 3, fiscal_quarter: Q2 2025}
          - {order_id: 4, fiscal_quarter: Q1 2022}


# # I want to test:
#   # If order_date: 2022-12-01, fiscal_quarter: Q4 2022
#   #   order_date: 2025-12-01, fiscal_quarter: Q1 2026
#   #   order_date: 2025-02-01, fiscal_quarter: Q2 2025
#   #   order_date: 2022-02-01, fiscal_quarter: Q1 2022
    

              
